const VERSION="7c3469a0-f860-11ea-9685-8b0635edb1b6",CACHE="mozilla-iot-cache-"+VERSION;self.addEventListener("install",()=>{self.skipWaiting()}),self.addEventListener("activate",e=>{e.waitUntil(caches.keys().then(e=>Promise.all(e.filter(e=>CACHE!==e).map(e=>caches.delete(e)))))}),self.addEventListener("fetch",e=>{if("application/json"===e.request.headers.get("Accept")||"GET"!==e.request.method||!["no-cors","navigate"].includes(e.request.mode))return;const t=new URL(e.request.url);t.origin!==location.origin||t.pathname.endsWith(".map")||t.pathname.endsWith("floorplan.svg")||t.pathname.startsWith("/internal-logs")||t.pathname.startsWith("/extensions")||t.pathname.startsWith("/oauth/allow")||e.respondWith((async()=>{const t=await caches.open(CACHE),a=await t.match(e.request,{ignoreVary:!0});if(a)return a;const s=await fetch(e.request);return await t.put(e.request,s.clone()),s})())}),self.addEventListener("push",e=>{const t=e.data?e.data.text():"";e.waitUntil(self.registration.showNotification("Mozilla WebThings Gateway",{body:t}))});